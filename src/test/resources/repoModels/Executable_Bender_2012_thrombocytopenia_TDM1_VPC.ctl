; Script generated by the pharmML2Nmtran Converter v.0.4.0
; Source 	: PharmML 0.8.1
; Target 	: NMTRAN 7.3.0
; Model 	: Executable_Bender_2012_thrombocytopenia_TDM1
; Model Name: Generated from MDL. MOG ID: bender2012_mog
; Dated 	: Wed Sep 21 13:27:00 CEST 2016

$PROBLEM Generated from MDL. MOG ID: bender2012_mog

$INPUT  ID TRT NAMT=DROP DSFQ=DROP AMT DUR=DROP RATE TIME DAY ODV=DROP DV EV=DROP CMT MDV ICL IV1 IQ IV2 CAVG VISI POP
$DATA "Simulated_data10_POP.csv" IGNORE=@
$SUBS ADVAN13 TOL=9

$MODEL 
COMP (COMP1) 	;A1
COMP (COMP2) 	;A2
COMP (COMP3) 	;T1
COMP (COMP4) 	;PP
COMP (COMP5) 	;T2
COMP (COMP6) 	;T3
COMP (COMP7) 	;PLT



$PK 
RUV_ADD = THETA(1)
POP_KDEP1 = THETA(2)
POP_KDEP2 = THETA(3)
POP_SLOPE1 = THETA(4)
POP_SLOPE2 = THETA(5)
POP_MTT = THETA(6)
POP_GAM = THETA(7)
POP_BASE = THETA(8)
POP_BASE1 = THETA(9)

ETA_MTT = ETA(1)
ETA_GAM = ETA(2)
ETA_BASE = ETA(3)
ETA_BASE1 = ETA(4)
ETA_KDEP = ETA(5)
ETA_SLOPE1 = ETA(6)
ETA_SLOPE2 = ETA(7)

PPV_GAM = 0.0 
K10 = (ICL/IV1) 
K12 = (IQ/IV1) 
K21 = (IQ/IV2) 

KDEP = ((POP_KDEP2/1000000)*EXP(ETA_KDEP)) 
IF (POP.EQ.1) THEN
	KDEP = ((POP_KDEP1/1000000)*EXP(ETA_KDEP)) 
ENDIF

 


SLOPE = ((POP_SLOPE2/1000)*EXP(ETA_SLOPE2)) 
IF (VISI.EQ.1) THEN
	SLOPE = ((POP_SLOPE1/1000)*EXP(ETA_SLOPE1)) 
ENDIF

 


MTT = (POP_MTT*EXP(ETA_MTT))

GAM = (POP_GAM*EXP(ETA_GAM))

BASE = (POP_BASE*EXP(ETA_BASE))

BASE1 = (POP_BASE1*EXP(ETA_BASE1))

KTR = (4/MTT)

A_0(1) = 0
A_0(2) = 0
A_0(3) = BASE
A_0(4) = BASE
A_0(5) = BASE
A_0(6) = BASE
A_0(7) = BASE

$DES 
A1_DES = A(1)
A2_DES = A(2)
T1_DES = A(3)
PP_DES = A(4)
T2_DES = A(5)
T3_DES = A(6)
PLT_DES = A(7)
KDEPEFF_DES = (KDEP*CAVG)
BT_DES = (((BASE-BASE1)*EXP((-(KDEPEFF_DES)*T)))+BASE1)
CP_DES = (A1_DES/IV1)
EFF_DES = (SLOPE*CP_DES)
LOGPLT_DES = LOG(0.025) 
IF (PLT_DES.GT.0) THEN
	LOGPLT_DES = LOG(PLT_DES) 
ENDIF
DADT(1) = (((K21*A2_DES)-(K12*A1_DES))-(K10*A1_DES))
DADT(2) = ((K12*A1_DES)-(K21*A2_DES))
DADT(3) = ((-(KTR)*T1_DES)+(KTR*PP_DES))
DADT(4) = ((-(KTR)*PP_DES)+(((KTR*PP_DES)*(1-EFF_DES))*((BT_DES/PLT_DES)**GAM)))
DADT(5) = ((-(KTR)*T2_DES)+(KTR*T1_DES))
DADT(6) = ((-(KTR)*T3_DES)+(KTR*T2_DES))
DADT(7) = ((-(KTR)*PLT_DES)+(KTR*T3_DES))

$ERROR 
EPS_1 = EPS(1)

A1 = A(1)
A2 = A(2)
T1 = A(3)
PP = A(4)
T2 = A(5)
T3 = A(6)
PLT = A(7)
KDEPEFF = (KDEP*CAVG)
BT = (((BASE-BASE1)*EXP((-(KDEPEFF)*TIME)))+BASE1)
CP = (A1/IV1)
EFF = (SLOPE*CP)
LOGPLT = LOG(0.025) 
IF (PLT.GT.0) THEN
	LOGPLT = LOG(PLT) 
ENDIF
IPRED = LOGPLT
W = RUV_ADD
Y = IPRED+W*EPS_1
IRES = DV - IPRED
IWRES = IRES/W

$THETA 
( 0.0 , 0.18 )	;RUV_ADD
( 0.0 , 50.0 )	;POP_KDEP1
( 0.0 , 4.0 )	;POP_KDEP2
( 0.0 , 3.0 )	;POP_SLOPE1
( 0.0 , 2.0 )	;POP_SLOPE2
( 0.0 , 36.0 )	;POP_MTT
( 0.0 , 0.13 )	;POP_GAM
( 10.0 , 255.0 )	;POP_BASE
( 5.0 , 110.0 )	;POP_BASE1

$OMEGA 
(0.06 )	;PPV_MTT
(0.0  FIX )	;PPV_GAM
(0.1 )	;PPV_BASE
(0.14 )	;PPV_BASE1
(0.75 )	;PPV_KDEP
(0.13 )	;PPV_SLOPE1
(0.31 )	;PPV_SLOPE2

$SIGMA 
1.0 FIX


;$EST METHOD=COND NSIG=3 SIGL=9 MAXEVALS=9999 PRINT=10 NOABORT
$SIMULATION (603271) NSUB=200 ONLYSIM
$TABLE  ID TIME TRT AMT RATE DAY EVID CMT MDV ICL IV1 IQ IV2 CAVG VISI POP PRED IPRED RES IRES WRES IWRES Y DV NOAPPEND NOPRINT FILE=sdtab


