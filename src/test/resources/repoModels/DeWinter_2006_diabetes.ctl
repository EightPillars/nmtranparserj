; Script generated by the pharmML2Nmtran Converter v.0.4.0
; Source 	: PharmML 0.8.1
; Target 	: NMTRAN 7.3.0
; Model 	: DeWinter_2006_diabetes
; Model Name: Generated from MDL. MOG ID: dewinter2006_mog
; Dated 	: Sun Sep 18 17:46:02 CEST 2016

$PROBLEM Generated from MDL. MOG ID: dewinter2006_mog

$INPUT  ID TIME DV STEP TREAT ORIG EVID
$DATA "Simulated_winter2006_data.csv" IGNORE=@
$SUBS ADVAN13 TOL=9

$MODEL 
COMP (COMP1) 	;FSI
COMP (COMP2) 	;FPG
COMP (COMP3) 	;HB



$PK 
RES_FPG = THETA(1)
RES_HB = THETA(2)
K_OUT_FPG = THETA(3)
K_OUT_HB = THETA(4)
POP_FRHB0 = THETA(5)
POP_B0 = THETA(6)
POP_RB_G = THETA(7)
POP_S0 = THETA(8)
POP_RS_G = THETA(9)
EF_B_G = THETA(10)
EF_S_M = THETA(11)
EF_S_P = THETA(12)
BETA_RB_P = THETA(13)
BETA_RB_M = THETA(14)
BETA_RS_P = THETA(15)
BETA_RS_M = THETA(16)
RES_FSI = THETA(17)
RES_FSI30 = THETA(18)

ETA_FRHB0 = ETA(1)
ETA_B0 = ETA(2)
ETA_S0 = ETA(3)
ETA_EFF = ETA(4)
ETA_RB = ETA(5)
ETA_RS = ETA(6)


TRT_M = 0 
IF (TREAT.EQ.0) THEN
	TRT_M = 1 
ENDIF

 


TRT_P = 0 
IF (TREAT.EQ.1) THEN
	TRT_P = 1 
ENDIF

 


TRT_G = 0 
IF (TREAT.EQ.2) THEN
	TRT_G = 1 
ENDIF

 


SHIFT_EF_B_G = (EF_B_G*EXP(ETA_EFF))

SHIFT_EF_S_M = (EF_S_M*EXP(ETA_EFF))

SHIFT_EF_S_P = (EF_S_P*EXP(ETA_EFF))

FRHB0 = (POP_FRHB0*EXP(ETA_FRHB0))

B0 = (POP_B0*EXP(ETA_B0))

S0 = (POP_S0*EXP(ETA_S0))

RB = ((POP_RB_G*((1+(TRT_P*BETA_RB_P))+(TRT_M*BETA_RB_M)))+ETA_RB)

RS = ((POP_RS_G*((1+(TRT_P*BETA_RS_P))+(TRT_M*BETA_RS_M)))+ETA_RS)

K_OUT_FSI = 1

BB0 = (1/(1+EXP(B0)))

SS0 = (1/(1+EXP(S0)))

FSI0 = ((((-(5)*3.5)*BB0)+SQRT(((((5*3.5)*BB0)**2)+((((4*5)*22.5)*BB0)/SS0))))/2)

FPG0 = (22.5/(SS0*FSI0))

HB0 = (FRHB0*FPG0)

K_IN_FSI = (5*K_OUT_FSI)

K_IN_FPG = (22.5*K_OUT_FPG)

K_IN_HB = (FRHB0*K_OUT_HB)

A_0(1) = FSI0
A_0(2) = FPG0
A_0(3) = HB0

$DES 
FSI_DES = A(1)
FPG_DES = A(2)
HB_DES = A(3)
BB_DES = (1/(1+EXP((B0+((RB*T)/365)))))
SS_DES = (1/(1+EXP((S0+((RS*T)/365)))))
EF_B_DES = (1+((TRT_G*STEP)*SHIFT_EF_B_G))
EF_S_DES = ((1+((TRT_M*STEP)*SHIFT_EF_S_M))+((TRT_P*STEP)*SHIFT_EF_S_P))
RES_FSI_IND_DES = (((RES_FSI**2)+(RES_FSI30**2))**0.5) 
IF (FSI_DES.LE.30) THEN
	RES_FSI_IND_DES = RES_FSI 
ENDIF
LOGFSI_DES = LOG(FSI_DES)
LOGFPG_DES = LOG(FPG_DES)
LOGHB_DES = LOG(HB_DES)
DADT(1) = ((((EF_B_DES*BB_DES)*(FPG_DES-3.5))*K_IN_FSI)-(FSI_DES*K_OUT_FSI))
DADT(2) = ((K_IN_FPG/((EF_S_DES*SS_DES)*FSI_DES))-(FPG_DES*K_OUT_FPG))
DADT(3) = ((FPG_DES*K_IN_HB)-(HB_DES*K_OUT_HB))

$ERROR 
EPS_RES_FSI = EPS(1)
EPS_RES_FPG = EPS(2)
EPS_RES_HB = EPS(3)

FSI = A(1)
FPG = A(2)
HB = A(3)
BB = (1/(1+EXP((B0+((RB*TIME)/365)))))
SS = (1/(1+EXP((S0+((RS*TIME)/365)))))
EF_B = (1+((TRT_G*STEP)*SHIFT_EF_B_G))
EF_S = ((1+((TRT_M*STEP)*SHIFT_EF_S_M))+((TRT_P*STEP)*SHIFT_EF_S_P))
RES_FSI_IND = (((RES_FSI**2)+(RES_FSI30**2))**0.5) 
IF (FSI.LE.30) THEN
	RES_FSI_IND = RES_FSI 
ENDIF
LOGFSI = LOG(FSI)
LOGFPG = LOG(FPG)
LOGHB = LOG(HB)

IF(ORIG.EQ.1) THEN
	IPRED = LOGFSI
W = RES_FSI_IND
Y = IPRED+W*EPS_RES_FSI
IRES = DV - IPRED
IWRES = IRES/W

ENDIF

IF(ORIG.EQ.2) THEN
	IPRED = LOGFPG
W = RES_FPG
Y = IPRED+W*EPS_RES_FPG
IRES = DV - IPRED
IWRES = IRES/W

ENDIF

IF(ORIG.EQ.3) THEN
	IPRED = LOGHB
W = RES_HB
Y = IPRED+W*EPS_RES_HB
IRES = DV - IPRED
IWRES = IRES/W

ENDIF

$THETA 
(0.1277 )	;RES_FPG
(0.0438 )	;RES_HB
(0.021 )	;K_OUT_FPG
(0.0272 )	;K_OUT_HB
(0.82 )	;POP_FRHB0
(0.635 )	;POP_B0
(0.178 )	;POP_RB_G
(1.38 )	;POP_S0
(0.245 )	;POP_RS_G
(1.115 )	;EF_B_G
(0.699 )	;EF_S_M
(0.649 )	;EF_S_P
(-2.24 )	;BETA_RB_P
(-2.82 )	;BETA_RB_M
(0.567 )	;BETA_RS_P
(1.01 )	;BETA_RS_M
(0.2985 )	;RES_FSI
(0.6124 )	;RES_FSI30

$OMEGA BLOCK(3)  
(0.0158 )	;OMEGA_FRHB0
(-0.053 )	;COV_B0_FRHB0
(0.967 )	;OMEGA_B0
(-0.0185 )	;COV_S0_FRHB0
(-0.48 )	;COV_B0_S0
(0.519 )	;OMEGA_S0

$OMEGA 
(0.13 )	;OMEGA_EFF
(0.0125 )	;OMEGA_RB
(0.00805 )	;OMEGA_RS

$SIGMA 
1.0 FIX	;SIGMA_RES_FSI
1.0 FIX	;SIGMA_RES_FPG
1.0 FIX	;SIGMA_RES_HB


$EST METHOD=COND INTER NSIG=3 SIGL=9 MAXEVALS=9999 PRINT=10 NOABORT

$TABLE  ID TIME STEP TREAT ORIG EVID PRED RES WRES DV IPRED IRES IWRES Y NOAPPEND NOPRINT FILE=sdtab

$TABLE  ID SHIFT_EF_B_G SHIFT_EF_S_M SHIFT_EF_S_P FRHB0 B0 S0 RB RS K_OUT_FSI BB0 SS0 FSI0 FPG0 HB0 K_IN_FSI K_IN_FPG K_IN_HB ETA_FRHB0 ETA_B0 ETA_S0 ETA_EFF ETA_RB ETA_RS NOAPPEND NOPRINT FILE=patab

$TABLE  ID STEP TREAT NOAPPEND NOPRINT FILE=cotab


